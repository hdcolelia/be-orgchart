// getting base64 icons
import { expandBase64Data } from './../../../assets/icons/expand.base64';
import { collapseBase64Data } from './../../../assets/icons/collapse.base64';
import { errorBase64Data } from './../../../assets/icons/error.base64';
export class D3NodeBasicParser {
    constructor() {
        // dimensions
        this.width = 220;
        this.height = 80;
        // expand / colapse icons
        this.expandBase64Icon = expandBase64Data;
        this.collapseBase64Icon = collapseBase64Data;
        // error icon
        this.errorBase64Icon = errorBase64Data;
        this.imageDefs = {
            x: -20, y: -15, h: 60, w: 60, rx: 6
        };
        this.transitionDuration = 500;
    }
    addImage() {
    }
    drawNodes(prGroup) {
        const me = this;
        prGroup.each((d, i) => me.drawNode(d, i, prGroup));
    }
    drawNode(prData, prIndex, node) {
        const me = this;
        // adding rect
        node.append('rect').attr('class', 'node-rect')
            .attr('width', me.width).attr('height', me.height)
            .attr('stroke', 'blue').attr('stroke-width', 1)
            .attr('fill', '#02B2AC').attr('rx', 12);
        // adding title
        node.append('text').text(d => d.data.title)
            .attr('font-size', 15).attr('x', 50).attr('y', 25);
        // adding description
        node.append('text').text(d => d.data.description)
            .attr('font-size', 10).attr('x', 50).attr('y', 45);
        // prGroup.
        if (prData.data.nodeImage) {
            const defs = node.append('defs').append('pattern')
                .attr('id', d => `img-${d.data.nodeId}`)
                .attr('width', 1)
                .attr('height', 1);
            let linkRef = '';
            if (prData.data.nodeImage.url)
                linkRef = prData.data.nodeImage.url;
            if (prData.data.nodeImage.icon)
                linkRef = prData.data.nodeImage.icon;
            if (prData.data.nodeImage.base64)
                linkRef = `data:image/png;base64,${prData.data.nodeImage.base64}`;
            const image = defs.append('image')
                .attr('xlink:href', linkRef)
                .attr('width', me.imageDefs.w)
                .attr('height', me.imageDefs.h)
                // .attr('viewbox', '0 0 100 100')
                .attr('preserveAspectRatio', 'xMidYMin slice');
            // adding image
            node.append('rect').attr('class', 'node-image')
                .attr('x', me.imageDefs.x).attr('y', me.imageDefs.y)
                .attr('width', me.imageDefs.w).attr('height', me.imageDefs.h)
                // .attr('stroke', 'blue').attr('stroke-width', 1)
                .attr('fill', d => `url(#img-${d.data.nodeId})`).attr('rx', me.imageDefs.rx);
        }
    }
    xxxdrawNodes(prGroup) {
        const me = this;
        prGroup
            .append('defs')
            .append('pattern')
            .attr('id', d => `img-${d.data.nodeId}`)
            .attr('width', 70)
            .attr('height', 70)
            .append('image')
            .attr('xlink:href', d => d.data.nodeImage.url)
            .attr('width', 70)
            .attr('height', 70);
        // adding rect
        prGroup.append('rect').attr('class', 'node-rect')
            .attr('width', me.width).attr('height', me.height)
            .attr('stroke', 'blue').attr('stroke-width', 1)
            .attr('fill', 'gray').attr('rx', 12);
        // adding title
        prGroup.append('text').text(d => d.data.title)
            .attr('font-size', 10).attr('x', 70).attr('y', 25);
        // adding description
        prGroup.append('text').text(d => d.data.description)
            .attr('font-size', 10).attr('x', 70).attr('y', 45);
        // adding image
        prGroup.append('rect').attr('class', 'node-image')
            .attr('x', 5).attr('y', 10)
            .attr('width', 50).attr('height', 50)
            .attr('fill', d => `url(#img-${d.data.nodeId})`);
        // prGroup.
    }
    updateNodes(prGroup, prNodes) {
        prGroup.select('rect.node-rect').attr('fill', 'black');
        //  .each(d => {
        //    console.log('argument: ', d);
        //  })
        //.data(prNodes).select('rect.node-rect')
        //.attr('x', d => d.x)
        //.attr('y', d => d.y);
        // console.log('Updateing...:', prGroup)
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZS1iYXNpYy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2JlLWQzLW9yZ2NoYXJ0LyIsInNvdXJjZXMiOlsibGliL2NsYXNlc3MvQGl0ZW1zL2Jhc2ljL25vZGUtYmFzaWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsdUJBQXVCO0FBQ3ZCLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHVDQUF1QyxDQUFDO0FBQ3pFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQzdFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUd2RSxNQUFNLE9BQU8saUJBQWlCO0lBQzVCO1FBQ0EsYUFBYTtRQUNiLFVBQUssR0FBVyxHQUFHLENBQUM7UUFDcEIsV0FBTSxHQUFXLEVBQUUsQ0FBQztRQUVwQix5QkFBeUI7UUFDekIscUJBQWdCLEdBQUcsZ0JBQWdCLENBQUM7UUFDcEMsdUJBQWtCLEdBQUcsa0JBQWtCLENBQUM7UUFFeEMsYUFBYTtRQUNiLG9CQUFlLEdBQUcsZUFBZSxDQUFDO1FBRWxDLGNBQVMsR0FBK0Q7WUFDdEUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7U0FDcEMsQ0FBQTtRQUVELHVCQUFrQixHQUFXLEdBQUcsQ0FBQztJQWhCakIsQ0FBQztJQWtCUCxRQUFRO0lBRWxCLENBQUM7SUFFRCxTQUFTLENBQ1AsT0FBNEU7UUFFNUUsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDO1FBQ2hCLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUNyRCxDQUFDO0lBRUQsUUFBUSxDQUFDLE1BQXNDLEVB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RUFBRSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQzthQUNwQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFDbkQsV0FBVztJQUViLENBQUM7SUFFRCxXQUFXLENBQUMsT0FBaUQsRUFBRSxPQUF5QztRQUN0RyxPQUFPLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQTtRQUN0RCxnQkFBZ0I7UUFDaEIsbUNBQW1DO1FBQ25DLE1BQU07UUFFTix5Q0FBeUM7UUFDekMsc0JBQXNCO1FBQ3RCLHVCQUF1QjtRQUN2Qix3Q0FBd0M7SUFDMUMsQ0FBQztDQUVGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZDMgZnJvbSAnZDMnO1xyXG5pbXBvcnQgeyBJRDNOb2RlIH0gZnJvbSAnLi8uLi8uLi8uLi9pbnRlcmZhY2VzJztcclxuXHJcbi8vIGdldHRpbmcgYmFzZTY0IGljb25zXHJcbmltcG9ydCB7IGV4cGFuZEJhc2U2NERhdGEgfSBmcm9tICcuLy4uLy4uLy4uL2Fzc2V0cy9pY29ucy9leHBhbmQuYmFzZTY0JztcclxuaW1wb3J0IHsgY29sbGFwc2VCYXNlNjREYXRhIH0gZnJvbSAnLi8uLi8uLi8uLi9hc3NldHMvaWNvbnMvY29sbGFwc2UuYmFzZTY0JztcclxuaW1wb3J0IHsgZXJyb3JCYXNlNjREYXRhIH0gZnJvbSAnLi8uLi8uLi8uLi9hc3NldHMvaWNvbnMvZXJyb3IuYmFzZTY0JztcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgRDNOb2RlQmFzaWNQYXJzZXIge1xyXG4gIGNvbnN0cnVjdG9yKCkgeyB9XHJcbiAgLy8gZGltZW5zaW9uc1xyXG4gIHdpZHRoOiBudW1iZXIgPSAyMjA7XHJcbiAgaGVpZ2h0OiBudW1iZXIgPSA4MDtcclxuXHJcbiAgLy8gZXhwYW5kIC8gY29sYXBzZSBpY29uc1xyXG4gIGV4cGFuZEJhc2U2NEljb24gPSBleHBhbmRCYXNlNjREYXRhO1xyXG4gIGNvbGxhcHNlQmFzZTY0SWNvbiA9IGNvbGxhcHNlQmFzZTY0RGF0YTtcclxuXHJcbiAgLy8gZXJyb3IgaWNvblxyXG4gIGVycm9yQmFzZTY0SWNvbiA9IGVycm9yQmFzZTY0RGF0YTtcclxuXHJcbiAgaW1hZ2VEZWZzOiB7IHg6IG51bWJlciwgeTogbnVtYmVyLCBoOiBudW1iZXIsIHc6IG51bWJlciwgcng6IG51bWJlciB9ID0ge1xyXG4gICAgeDogLTIwLCB5OiAtMTUsIGg6IDYwLCB3OiA2MCwgcng6IDZcclxuICB9XHJcblxyXG4gIHRyYW5zaXRpb25EdXJhdGlvbjogbnVtYmVyID0gNTAwO1xyXG5cclxuICBwcm90ZWN0ZWQgYWRkSW1hZ2UoKSB7XHJcblxyXG4gIH1cclxuXHJcbiAgZHJhd05vZGVzKFxyXG4gICAgcHJHcm91cDogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4sIGFueSwgYW55PlxyXG4gICkge1xyXG4gICAgY29uc3QgbWUgPSB0aGlzO1xyXG4gICAgcHJHcm91cC5lYWNoKChkLCBpKSA9PiBtZS5kcmF3Tm9kZShkLCBpLCBwckdyb3VwKSk7XHJcbiAgfVxyXG5cclxuICBkcmF3Tm9kZShwckRhdGE6IGQzLkhpZXJhcmNoeVBvaW50Tm9kZTxJRDNOb2RlPiwgcHJJbmRleDogbnVtYmVyLCBub2RlOiBkMy5TZWxlY3Rpb248U1ZHR0VsZW1lbnQsIGQzLkhpZXJhcmNoeVBvaW50Tm9kZTxJRDNOb2RlPiwgYW55LCBhbnk+KSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcbiAgICBcclxuICAgIC8vIGFkZGluZyByZWN0XHJcbiAgICBub2RlLmFwcGVuZCgncmVjdCcpLmF0dHIoJ2NsYXNzJywgJ25vZGUtcmVjdCcpXHJcbiAgICAgIC5hdHRyKCd3aWR0aCcsIG1lLndpZHRoKS5hdHRyKCdoZWlnaHQnLCBtZS5oZWlnaHQpXHJcbiAgICAgIC5hdHRyKCdzdHJva2UnLCAnYmx1ZScpLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDEpXHJcbiAgICAgIC5hdHRyKCdmaWxsJywgJyMwMkIyQUMnKS5hdHRyKCdyeCcsIDEyKTtcclxuXHJcbiAgICAvLyBhZGRpbmcgdGl0bGVcclxuICAgIG5vZGUuYXBwZW5kKCd0ZXh0JykudGV4dChkID0+IGQuZGF0YS50aXRsZSlcclxuICAgICAgLmF0dHIoJ2ZvbnQtc2l6ZScsIDE1KS5hdHRyKCd4JywgNTApLmF0dHIoJ3knLCAyNSk7XHJcblxyXG4gICAgLy8gYWRkaW5nIGRlc2NyaXB0aW9uXHJcbiAgICBub2RlLmFwcGVuZCgndGV4dCcpLnRleHQoZCA9PiBkLmRhdGEuZGVzY3JpcHRpb24pXHJcbiAgICAgIC5hdHRyKCdmb250LXNpemUnLCAxMCkuYXR0cigneCcsIDUwKS5hdHRyKCd5JywgNDUpO1xyXG4gICAgLy8gcHJHcm91cC5cclxuXHJcblxyXG4gICAgaWYocHJEYXRhLmRhdGEubm9kZUltYWdlKSB7XHJcbiAgICAgIGNvbnN0IGRlZnMgPSBub2RlLmFwcGVuZCgnZGVmcycpLmFwcGVuZCgncGF0dGVybicpXHJcbiAgICAgICAgLmF0dHIoJ2lkJywgZCA9PiBgaW1nLSR7ZC5kYXRhLm5vZGVJZH1gKVxyXG4gICAgICAgIC5hdHRyKCd3aWR0aCcsIDEpXHJcbiAgICAgICAgLmF0dHIoJ2hlaWdodCcsIDEpO1xyXG4gICAgICBcclxuICAgICAgbGV0IGxpbmtSZWY6IHN0cmluZyA9ICcnXHJcbiAgICAgIGlmKHByRGF0YS5kYXRhLm5vZGVJbWFnZS51cmwpIGxpbmtSZWYgPSBwckRhdGEuZGF0YS5ub2RlSW1hZ2UudXJsO1xyXG4gICAgICBpZihwckRhdGEuZGF0YS5ub2RlSW1hZ2UuaWNvbikgbGlua1JlZiA9IHByRGF0YS5kYXRhLm5vZGVJbWFnZS5pY29uO1xyXG4gICAgICBpZihwckRhdGEuZGF0YS5ub2RlSW1hZ2UuYmFzZTY0KSBsaW5rUmVmID0gYGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwke3ByRGF0YS5kYXRhLm5vZGVJbWFnZS5iYXNlNjR9YDtcclxuXHJcbiAgICAgIGNvbnN0IGltYWdlID0gZGVmcy5hcHBlbmQoJ2ltYWdlJylcclxuICAgICAgICAuYXR0cigneGxpbms6aHJlZicsIGxpbmtSZWYpXHJcbiAgICAgICAgLmF0dHIoJ3dpZHRoJywgbWUuaW1hZ2VEZWZzLncpXHJcbiAgICAgICAgLmF0dHIoJ2hlaWdodCcsIG1lLmltYWdlRGVmcy5oKVxyXG4gICAgICAgIC8vIC5hdHRyKCd2aWV3Ym94JywgJzAgMCAxMDAgMTAwJylcclxuXHJcbiAgICAgIC5hdHRyKCdwcmVzZXJ2ZUFzcGVjdFJhdGlvJywgJ3hNaWRZTWluIHNsaWNlJyk7XHJcbiAgICAgIC8vIGFkZGluZyBpbWFnZVxyXG4gICAgICBub2RlLmFwcGVuZCgncmVjdCcpLmF0dHIoJ2NsYXNzJywgJ25vZGUtaW1hZ2UnKVxyXG4gICAgICAuYXR0cigneCcsIG1lLmltYWdlRGVmcy54KS5hdHRyKCd5JywgbWUuaW1hZ2VEZWZzLnkpXHJcbiAgICAgIC5hdHRyKCd3aWR0aCcsIG1lLmltYWdlRGVmcy53KS5hdHRyKCdoZWlnaHQnLCBtZS5pbWFnZURlZnMuaClcclxuICAgICAgLy8gLmF0dHIoJ3N0cm9rZScsICdibHVlJykuYXR0cignc3Ryb2tlLXdpZHRoJywgMSlcclxuICAgICAgLmF0dHIoJ2ZpbGwnLCBkID0+IGB1cmwoI2ltZy0ke2QuZGF0YS5ub2RlSWR9KWApLmF0dHIoJ3J4JywgbWUuaW1hZ2VEZWZzLnJ4KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHh4eGRyYXdOb2RlcyhcclxuICAgIHByR3JvdXA6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwgZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+LCBhbnksIGFueT5cclxuICApIHtcclxuICAgIGNvbnN0IG1lID0gdGhpcztcclxuICAgIHByR3JvdXBcclxuICAgICAgLmFwcGVuZCgnZGVmcycpXHJcbiAgICAgIC5hcHBlbmQoJ3BhdHRlcm4nKVxyXG4gICAgICAuYXR0cignaWQnLCBkID0+IGBpbWctJHtkLmRhdGEubm9kZUlkfWApXHJcbiAgICAgIC5hdHRyKCd3aWR0aCcsIDcwKVxyXG4gICAgICAuYXR0cignaGVpZ2h0JywgNzApXHJcbiAgICAgIC5hcHBlbmQoJ2ltYWdlJylcclxuICAgICAgLmF0dHIoJ3hsaW5rOmhyZWYnLCBkID0+IGQuZGF0YS5ub2RlSW1hZ2UudXJsKVxyXG4gICAgICAuYXR0cignd2lkdGgnLCA3MClcclxuICAgICAgLmF0dHIoJ2hlaWdodCcsIDcwKTtcclxuXHJcbiAgICAvLyBhZGRpbmcgcmVjdFxyXG4gICAgcHJHcm91cC5hcHBlbmQoJ3JlY3QnKS5hdHRyKCdjbGFzcycsICdub2RlLXJlY3QnKVxyXG4gICAgICAuYXR0cignd2lkdGgnLCBtZS53aWR0aCkuYXR0cignaGVpZ2h0JywgbWUuaGVpZ2h0KVxyXG4gICAgICAuYXR0cignc3Ryb2tlJywgJ2JsdWUnKS5hdHRyKCdzdHJva2Utd2lkdGgnLCAxKVxyXG4gICAgICAuYXR0cignZmlsbCcsICdncmF5JykuYXR0cigncngnLCAxMik7XHJcblxyXG4gICAgLy8gYWRkaW5nIHRpdGxlXHJcbiAgICBwckdyb3VwLmFwcGVuZCgndGV4dCcpLnRleHQoZCA9PiBkLmRhdGEudGl0bGUpXHJcbiAgICAgIC5hdHRyKCdmb250LXNpemUnLCAxMCkuYXR0cigneCcsIDcwKS5hdHRyKCd5JywgMjUpO1xyXG5cclxuICAgIC8vIGFkZGluZyBkZXNjcmlwdGlvblxyXG4gICAgcHJHcm91cC5hcHBlbmQoJ3RleHQnKS50ZXh0KGQgPT4gZC5kYXRhLmRlc2NyaXB0aW9uKVxyXG4gICAgICAuYXR0cignZm9udC1zaXplJywgMTApLmF0dHIoJ3gnLCA3MCkuYXR0cigneScsIDQ1KTtcclxuXHJcbiAgICAvLyBhZGRpbmcgaW1hZ2VcclxuICAgIHByR3JvdXAuYXBwZW5kKCdyZWN0JykuYXR0cignY2xhc3MnLCAnbm9kZS1pbWFnZScpXHJcbiAgICAgIC5hdHRyKCd4JywgNSkuYXR0cigneScsIDEwKVxyXG4gICAgICAuYXR0cignd2lkdGgnLCA1MCkuYXR0cignaGVpZ2h0JywgNTApXHJcbiAgICAgIC5hdHRyKCdmaWxsJywgZCA9PiBgdXJsKCNpbWctJHtkLmRhdGEubm9kZUlkfSlgKTtcclxuICAgIC8vIHByR3JvdXAuXHJcblxyXG4gIH1cclxuXHJcbiAgdXBkYXRlTm9kZXMocHJHcm91cDogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCBhbnksIGFueSwgYW55PiwgcHJOb2RlczogZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+W10pIHtcclxuICAgIHByR3JvdXAuc2VsZWN0KCdyZWN0Lm5vZGUtcmVjdCcpLmF0dHIoJ2ZpbGwnLCAnYmxhY2snKVxyXG4gICAgLy8gIC5lYWNoKGQgPT4ge1xyXG4gICAgLy8gICAgY29uc29sZS5sb2coJ2FyZ3VtZW50OiAnLCBkKTtcclxuICAgIC8vICB9KVxyXG5cclxuICAgIC8vLmRhdGEocHJOb2Rlcykuc2VsZWN0KCdyZWN0Lm5vZGUtcmVjdCcpXHJcbiAgICAvLy5hdHRyKCd4JywgZCA9PiBkLngpXHJcbiAgICAvLy5hdHRyKCd5JywgZCA9PiBkLnkpO1xyXG4gICAgLy8gY29uc29sZS5sb2coJ1VwZGF0ZWluZy4uLjonLCBwckdyb3VwKVxyXG4gIH1cclxuXHJcbn0iXX0=