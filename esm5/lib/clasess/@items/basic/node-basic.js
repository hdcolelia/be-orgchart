// getting base64 icons
import { expandBase64Data } from './../../../assets/icons/expand.base64';
import { collapseBase64Data } from './../../../assets/icons/collapse.base64';
import { errorBase64Data } from './../../../assets/icons/error.base64';
var D3NodeBasicParser = /** @class */ (function () {
    function D3NodeBasicParser() {
        // dimensions
        this.width = 220;
        this.height = 80;
        // expand / colapse icons
        this.expandBase64Icon = expandBase64Data;
        this.collapseBase64Icon = collapseBase64Data;
        // error icon
        this.errorBase64Icon = errorBase64Data;
        this.imageDefs = {
            x: -20, y: -15, h: 60, w: 60, rx: 6
        };
        this.transitionDuration = 500;
    }
    D3NodeBasicParser.prototype.addImage = function () {
    };
    D3NodeBasicParser.prototype.drawNodes = function (prGroup) {
        var me = this;
        prGroup.each(function (d, i) { return me.drawNode(d, i, prGroup); });
    };
    D3NodeBasicParser.prototype.drawNode = function (prData, prIndex, node) {
        var me = this;
        // adding rect
        node.append('rect').attr('class', 'node-rect')
            .attr('width', me.width).attr('height', me.height)
            .attr('stroke', 'blue').attr('stroke-width', 1)
            .attr('fill', '#02B2AC').attr('rx', 12);
        // adding title
        node.append('text').text(function (d) { return d.data.title; })
            .attr('font-size', 15).attr('x', 50).attr('y', 25);
        // adding description
        node.append('text').text(function (d) { return d.data.description; })
            .attr('font-size', 10).attr('x', 50).attr('y', 45);
        // prGroup.
        if (prData.data.nodeImage) {
            var defs = node.append('defs').append('pattern')
                .attr('id', function (d) { return "img-" + d.data.nodeId; })
                .attr('width', 1)
                .attr('height', 1);
            var linkRef = '';
            if (prData.data.nodeImage.url)
                linkRef = prData.data.nodeImage.url;
            if (prData.data.nodeImage.icon)
                linkRef = prData.data.nodeImage.icon;
            if (prData.data.nodeImage.base64)
                linkRef = "data:image/png;base64," + prData.data.nodeImage.base64;
            var image = defs.append('image')
                .attr('xlink:href', linkRef)
                .attr('width', me.imageDefs.w)
                .attr('height', me.imageDefs.h)
                // .attr('viewbox', '0 0 100 100')
                .attr('preserveAspectRatio', 'xMidYMin slice');
            // adding image
            node.append('rect').attr('class', 'node-image')
                .attr('x', me.imageDefs.x).attr('y', me.imageDefs.y)
                .attr('width', me.imageDefs.w).attr('height', me.imageDefs.h)
                // .attr('stroke', 'blue').attr('stroke-width', 1)
                .attr('fill', function (d) { return "url(#img-" + d.data.nodeId + ")"; }).attr('rx', me.imageDefs.rx);
        }
    };
    D3NodeBasicParser.prototype.xxxdrawNodes = function (prGroup) {
        var me = this;
        prGroup
            .append('defs')
            .append('pattern')
            .attr('id', function (d) { return "img-" + d.data.nodeId; })
            .attr('width', 70)
            .attr('height', 70)
            .append('image')
            .attr('xlink:href', function (d) { return d.data.nodeImage.url; })
            .attr('width', 70)
            .attr('height', 70);
        // adding rect
        prGroup.append('rect').attr('class', 'node-rect')
            .attr('width', me.width).attr('height', me.height)
            .attr('stroke', 'blue').attr('stroke-width', 1)
            .attr('fill', 'gray').attr('rx', 12);
        // adding title
        prGroup.append('text').text(function (d) { return d.data.title; })
            .attr('font-size', 10).attr('x', 70).attr('y', 25);
        // adding description
        prGroup.append('text').text(function (d) { return d.data.description; })
            .attr('font-size', 10).attr('x', 70).attr('y', 45);
        // adding image
        prGroup.append('rect').attr('class', 'node-image')
            .attr('x', 5).attr('y', 10)
            .attr('width', 50).attr('height', 50)
            .attr('fill', function (d) { return "url(#img-" + d.data.nodeId + ")"; });
        // prGroup.
    };
    D3NodeBasicParser.prototype.updateNodes = function (prGroup, prNodes) {
        prGroup.select('rect.node-rect').attr('fill', 'black');
        //  .each(d => {
        //    console.log('argument: ', d);
        //  })
        //.data(prNodes).select('rect.node-rect')
        //.attr('x', d => d.x)
        //.attr('y', d => d.y);
        // console.log('Updateing...:', prGroup)
    };
    return D3NodeBasicParser;
}());
export { D3NodeBasicParser };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZS1iYXNpYy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BiZS9vcmdjaGFydC8iLCJzb3VyY2VzIjpbImxpYi9jbGFzZXNzL0BpdGVtcy9iYXNpYy9ub2RlLWJhc2ljLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLHVCQUF1QjtBQUN2QixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQztBQUN6RSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx5Q0FBeUMsQ0FBQztBQUM3RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFHdkU7SUFDRTtRQUNBLGFBQWE7UUFDYixVQUFLLEdBQVcsR0FBRyxDQUFDO1FBQ3BCLFdBQU0sR0FBVyxFQUFFLENBQUM7UUFFcEIseUJBQXlCO1FBQ3pCLHFCQUFnQixHQUFHLGdCQUFnQixDQUFDO1FBQ3BDLHVCQUFrQixHQUFHLGtCQUFrQixDQUFDO1FBRXhDLGFBQWE7UUFDYixvQkFBZSxHQUFHLGVBQWUsQ0FBQztRQUVsQyxjQUFTLEdBQStEO1lBQ3RFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDO1NBQ3BDLENBQUE7UUFFRCx1QkFBa0IsR0FBVyxHQUFHLENBQUM7SUFoQmpCLENBQUM7SUFrQlAsb0NBQVEsR0FBbEI7SUFFQSxDQUFDO0lBRUQscUNBQVMsR0FBVCxVQUNFLE9BQTRFO1FBRTVFLElBQU0sRUFBRSxHQUFHLElBQUksQ0FBQztRQUNoQixPQUFPLENBQUMsSUFBSSxDQUFDLFVBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSyxPQUFBLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxPQUFPLENBQUMsRUFBMUIsQ0FBMEIsQ0FBQyxDQUFDO0lBQ3JELENBQUM7SUFFRCxvQ0FBUSxHQUFSLFVBQVMsTUFB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QyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDO2FBQzFCLElBQUksQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUM7YUFDcEMsSUFBSSxDQUFDLE1BQU0sRUFBRSxVQUFBLENBQUMsSUFBSSxPQUFBLGNBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLE1BQUcsRUFBNUIsQ0FBNEIsQ0FBQyxDQUFDO1FBQ25ELFdBQVc7SUFFYixDQUFDO0lBRUQsdUNBQVcsR0FBWCxVQUFZLE9BQWlELEVBQUUsT0FBeUM7UUFDdEcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUE7UUFDdEQsZ0JBQWdCO1FBQ2hCLG1DQUFtQztRQUNuQyxNQUFNO1FBRU4seUNBQXlDO1FBQ3pDLHNCQUFzQjtRQUN0Qix1QkFBdUI7UUFDdkIsd0NBQXdDO0lBQzFDLENBQUM7SUFFSCx3QkFBQztBQUFELENBQUMsQUE5SEQsSUE4SEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XHJcbmltcG9ydCB7IElEM05vZGUgfSBmcm9tICcuLy4uLy4uLy4uL2ludGVyZmFjZXMnO1xyXG5cclxuLy8gZ2V0dGluZyBiYXNlNjQgaWNvbnNcclxuaW1wb3J0IHsgZXhwYW5kQmFzZTY0RGF0YSB9IGZyb20gJy4vLi4vLi4vLi4vYXNzZXRzL2ljb25zL2V4cGFuZC5iYXNlNjQnO1xyXG5pbXBvcnQgeyBjb2xsYXBzZUJhc2U2NERhdGEgfSBmcm9tICcuLy4uLy4uLy4uL2Fzc2V0cy9pY29ucy9jb2xsYXBzZS5iYXNlNjQnO1xyXG5pbXBvcnQgeyBlcnJvckJhc2U2NERhdGEgfSBmcm9tICcuLy4uLy4uLy4uL2Fzc2V0cy9pY29ucy9lcnJvci5iYXNlNjQnO1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBEM05vZGVCYXNpY1BhcnNlciB7XHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuICAvLyBkaW1lbnNpb25zXHJcbiAgd2lkdGg6IG51bWJlciA9IDIyMDtcclxuICBoZWlnaHQ6IG51bWJlciA9IDgwO1xyXG5cclxuICAvLyBleHBhbmQgLyBjb2xhcHNlIGljb25zXHJcbiAgZXhwYW5kQmFzZTY0SWNvbiA9IGV4cGFuZEJhc2U2NERhdGE7XHJcbiAgY29sbGFwc2VCYXNlNjRJY29uID0gY29sbGFwc2VCYXNlNjREYXRhO1xyXG5cclxuICAvLyBlcnJvciBpY29uXHJcbiAgZXJyb3JCYXNlNjRJY29uID0gZXJyb3JCYXNlNjREYXRhO1xyXG5cclxuICBpbWFnZURlZnM6IHsgeDogbnVtYmVyLCB5OiBudW1iZXIsIGg6IG51bWJlciwgdzogbnVtYmVyLCByeDogbnVtYmVyIH0gPSB7XHJcbiAgICB4OiAtMjAsIHk6IC0xNSwgaDogNjAsIHc6IDYwLCByeDogNlxyXG4gIH1cclxuXHJcbiAgdHJhbnNpdGlvbkR1cmF0aW9uOiBudW1iZXIgPSA1MDA7XHJcblxyXG4gIHByb3RlY3RlZCBhZGRJbWFnZSgpIHtcclxuXHJcbiAgfVxyXG5cclxuICBkcmF3Tm9kZXMoXHJcbiAgICBwckdyb3VwOiBkMy5TZWxlY3Rpb248U1ZHR0VsZW1lbnQsIGQzLkhpZXJhcmNoeVBvaW50Tm9kZTxJRDNOb2RlPiwgYW55LCBhbnk+XHJcbiAgKSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcbiAgICBwckdyb3VwLmVhY2goKGQsIGkpID0+IG1lLmRyYXdOb2RlKGQsIGksIHByR3JvdXApKTtcclxuICB9XHJcblxyXG4gIGRyYXdOb2RlKHByRGF0YTogZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+LCBwckluZGV4OiBudW1iZXIsIG5vZGU6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwgZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+LCBhbnksIGFueT4pIHtcclxuICAgIGNvbnN0IG1lID0gdGhpcztcclxuICAgIFxyXG4gICAgLy8gYWRkaW5nIHJlY3RcclxuICAgIG5vZGUuYXBwZW5kKCdyZWN0JykuYXR0cignY2xhc3MnLCAnbm9kZS1yZWN0JylcclxuICAgICAgLmF0dHIoJ3dpZHRoJywgbWUud2lkdGgpLmF0dHIoJ2hlaWdodCcsIG1lLmhlaWdodClcclxuICAgICAgLmF0dHIoJ3N0cm9rZScsICdibHVlJykuYXR0cignc3Ryb2tlLXdpZHRoJywgMSlcclxuICAgICAgLmF0dHIoJ2ZpbGwnLCAnIzAyQjJBQycpLmF0dHIoJ3J4JywgMTIpO1xyXG5cclxuICAgIC8vIGFkZGluZyB0aXRsZVxyXG4gICAgbm9kZS5hcHBlbmQoJ3RleHQnKS50ZXh0KGQgPT4gZC5kYXRhLnRpdGxlKVxyXG4gICAgICAuYXR0cignZm9udC1zaXplJywgMTUpLmF0dHIoJ3gnLCA1MCkuYXR0cigneScsIDI1KTtcclxuXHJcbiAgICAvLyBhZGRpbmcgZGVzY3JpcHRpb25cclxuICAgIG5vZGUuYXBwZW5kKCd0ZXh0JykudGV4dChkID0+IGQuZGF0YS5kZXNjcmlwdGlvbilcclxuICAgICAgLmF0dHIoJ2ZvbnQtc2l6ZScsIDEwKS5hdHRyKCd4JywgNTApLmF0dHIoJ3knLCA0NSk7XHJcbiAgICAvLyBwckdyb3VwLlxyXG5cclxuXHJcbiAgICBpZihwckRhdGEuZGF0YS5ub2RlSW1hZ2UpIHtcclxuICAgICAgY29uc3QgZGVmcyA9IG5vZGUuYXBwZW5kKCdkZWZzJykuYXBwZW5kKCdwYXR0ZXJuJylcclxuICAgICAgICAuYXR0cignaWQnLCBkID0+IGBpbWctJHtkLmRhdGEubm9kZUlkfWApXHJcbiAgICAgICAgLmF0dHIoJ3dpZHRoJywgMSlcclxuICAgICAgICAuYXR0cignaGVpZ2h0JywgMSk7XHJcbiAgICAgIFxyXG4gICAgICBsZXQgbGlua1JlZjogc3RyaW5nID0gJydcclxuICAgICAgaWYocHJEYXRhLmRhdGEubm9kZUltYWdlLnVybCkgbGlua1JlZiA9IHByRGF0YS5kYXRhLm5vZGVJbWFnZS51cmw7XHJcbiAgICAgIGlmKHByRGF0YS5kYXRhLm5vZGVJbWFnZS5pY29uKSBsaW5rUmVmID0gcHJEYXRhLmRhdGEubm9kZUltYWdlLmljb247XHJcbiAgICAgIGlmKHByRGF0YS5kYXRhLm5vZGVJbWFnZS5iYXNlNjQpIGxpbmtSZWYgPSBgZGF0YTppbWFnZS9wbmc7YmFzZTY0LCR7cHJEYXRhLmRhdGEubm9kZUltYWdlLmJhc2U2NH1gO1xyXG5cclxuICAgICAgY29uc3QgaW1hZ2UgPSBkZWZzLmFwcGVuZCgnaW1hZ2UnKVxyXG4gICAgICAgIC5hdHRyKCd4bGluazpocmVmJywgbGlua1JlZilcclxuICAgICAgICAuYXR0cignd2lkdGgnLCBtZS5pbWFnZURlZnMudylcclxuICAgICAgICAuYXR0cignaGVpZ2h0JywgbWUuaW1hZ2VEZWZzLmgpXHJcbiAgICAgICAgLy8gLmF0dHIoJ3ZpZXdib3gnLCAnMCAwIDEwMCAxMDAnKVxyXG5cclxuICAgICAgLmF0dHIoJ3ByZXNlcnZlQXNwZWN0UmF0aW8nLCAneE1pZFlNaW4gc2xpY2UnKTtcclxuICAgICAgLy8gYWRkaW5nIGltYWdlXHJcbiAgICAgIG5vZGUuYXBwZW5kKCdyZWN0JykuYXR0cignY2xhc3MnLCAnbm9kZS1pbWFnZScpXHJcbiAgICAgIC5hdHRyKCd4JywgbWUuaW1hZ2VEZWZzLngpLmF0dHIoJ3knLCBtZS5pbWFnZURlZnMueSlcclxuICAgICAgLmF0dHIoJ3dpZHRoJywgbWUuaW1hZ2VEZWZzLncpLmF0dHIoJ2hlaWdodCcsIG1lLmltYWdlRGVmcy5oKVxyXG4gICAgICAvLyAuYXR0cignc3Ryb2tlJywgJ2JsdWUnKS5hdHRyKCdzdHJva2Utd2lkdGgnLCAxKVxyXG4gICAgICAuYXR0cignZmlsbCcsIGQgPT4gYHVybCgjaW1nLSR7ZC5kYXRhLm5vZGVJZH0pYCkuYXR0cigncngnLCBtZS5pbWFnZURlZnMucngpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgeHh4ZHJhd05vZGVzKFxyXG4gICAgcHJHcm91cDogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4sIGFueSwgYW55PlxyXG4gICkge1xyXG4gICAgY29uc3QgbWUgPSB0aGlzO1xyXG4gICAgcHJHcm91cFxyXG4gICAgICAuYXBwZW5kKCdkZWZzJylcclxuICAgICAgLmFwcGVuZCgncGF0dGVybicpXHJcbiAgICAgIC5hdHRyKCdpZCcsIGQgPT4gYGltZy0ke2QuZGF0YS5ub2RlSWR9YClcclxuICAgICAgLmF0dHIoJ3dpZHRoJywgNzApXHJcbiAgICAgIC5hdHRyKCdoZWlnaHQnLCA3MClcclxuICAgICAgLmFwcGVuZCgnaW1hZ2UnKVxyXG4gICAgICAuYXR0cigneGxpbms6aHJlZicsIGQgPT4gZC5kYXRhLm5vZGVJbWFnZS51cmwpXHJcbiAgICAgIC5hdHRyKCd3aWR0aCcsIDcwKVxyXG4gICAgICAuYXR0cignaGVpZ2h0JywgNzApO1xyXG5cclxuICAgIC8vIGFkZGluZyByZWN0XHJcbiAgICBwckdyb3VwLmFwcGVuZCgncmVjdCcpLmF0dHIoJ2NsYXNzJywgJ25vZGUtcmVjdCcpXHJcbiAgICAgIC5hdHRyKCd3aWR0aCcsIG1lLndpZHRoKS5hdHRyKCdoZWlnaHQnLCBtZS5oZWlnaHQpXHJcbiAgICAgIC5hdHRyKCdzdHJva2UnLCAnYmx1ZScpLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDEpXHJcbiAgICAgIC5hdHRyKCdmaWxsJywgJ2dyYXknKS5hdHRyKCdyeCcsIDEyKTtcclxuXHJcbiAgICAvLyBhZGRpbmcgdGl0bGVcclxuICAgIHByR3JvdXAuYXBwZW5kKCd0ZXh0JykudGV4dChkID0+IGQuZGF0YS50aXRsZSlcclxuICAgICAgLmF0dHIoJ2ZvbnQtc2l6ZScsIDEwKS5hdHRyKCd4JywgNzApLmF0dHIoJ3knLCAyNSk7XHJcblxyXG4gICAgLy8gYWRkaW5nIGRlc2NyaXB0aW9uXHJcbiAgICBwckdyb3VwLmFwcGVuZCgndGV4dCcpLnRleHQoZCA9PiBkLmRhdGEuZGVzY3JpcHRpb24pXHJcbiAgICAgIC5hdHRyKCdmb250LXNpemUnLCAxMCkuYXR0cigneCcsIDcwKS5hdHRyKCd5JywgNDUpO1xyXG5cclxuICAgIC8vIGFkZGluZyBpbWFnZVxyXG4gICAgcHJHcm91cC5hcHBlbmQoJ3JlY3QnKS5hdHRyKCdjbGFzcycsICdub2RlLWltYWdlJylcclxuICAgICAgLmF0dHIoJ3gnLCA1KS5hdHRyKCd5JywgMTApXHJcbiAgICAgIC5hdHRyKCd3aWR0aCcsIDUwKS5hdHRyKCdoZWlnaHQnLCA1MClcclxuICAgICAgLmF0dHIoJ2ZpbGwnLCBkID0+IGB1cmwoI2ltZy0ke2QuZGF0YS5ub2RlSWR9KWApO1xyXG4gICAgLy8gcHJHcm91cC5cclxuXHJcbiAgfVxyXG5cclxuICB1cGRhdGVOb2Rlcyhwckdyb3VwOiBkMy5TZWxlY3Rpb248U1ZHR0VsZW1lbnQsIGFueSwgYW55LCBhbnk+LCBwck5vZGVzOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT5bXSkge1xyXG4gICAgcHJHcm91cC5zZWxlY3QoJ3JlY3Qubm9kZS1yZWN0JykuYXR0cignZmlsbCcsICdibGFjaycpXHJcbiAgICAvLyAgLmVhY2goZCA9PiB7XHJcbiAgICAvLyAgICBjb25zb2xlLmxvZygnYXJndW1lbnQ6ICcsIGQpO1xyXG4gICAgLy8gIH0pXHJcblxyXG4gICAgLy8uZGF0YShwck5vZGVzKS5zZWxlY3QoJ3JlY3Qubm9kZS1yZWN0JylcclxuICAgIC8vLmF0dHIoJ3gnLCBkID0+IGQueClcclxuICAgIC8vLmF0dHIoJ3knLCBkID0+IGQueSk7XHJcbiAgICAvLyBjb25zb2xlLmxvZygnVXBkYXRlaW5nLi4uOicsIHByR3JvdXApXHJcbiAgfVxyXG5cclxufSJdfQ==